<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      text-align: center;
    }
  </style>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
  <div id="chart"></div>

  <h2>Calculadora de Tempo de Resfriamento</h2>
  <label for="currentTemp">Temperatura Atual:</label>
  <input type="number" id="currentTemp" min="0" step="any">
  <br>
  <label for="targetTemp">Temperatura Desejada:</label>
  <input type="number" id="targetTemp" min="0" step="any">
  <br>
  <button onclick="calculateTime()">Calcular</button>
  <p id="result"></p>

  <script>
    // Dados de temperatura e tempo
    const data = [
      { hour: '11:29', temp: 1225 },
      { hour: '00:29', temp: 1003 },
      { hour: '01:29', temp: 847 },
      { hour: '02:29', temp: 772 },
      { hour: '03:29', temp: 620 },
      { hour: '04:29', temp: 535 },
      { hour: '05:29', temp: 463 },
      { hour: '06:29', temp: 402 },
      { hour: '07:29', temp: 350 },
      { hour: '08:29', temp: 307 },
      { hour: '09:29', temp: 270 }
    ];

    // Criação do gráfico
    const temperatures = data.map(entry => entry.temp);
    const hours = data.map(entry => entry.hour);

    const chartData = {
      x: hours,
      y: temperatures,
      type: 'scatter',
      mode: 'lines+markers'
    };

    const layout = {
      title: 'Taxa de Resfriamento do Forno',
      xaxis: { title: 'Hora' },
      yaxis: { title: 'Temperatura (°C)' }
    };

    const chart = document.getElementById('chart');
    Plotly.newPlot(chart, [chartData], layout);

    // Função para calcular o tempo de resfriamento
    function calculateTime() {
      const currentTemp = parseFloat(document.getElementById('currentTemp').value);
      const targetTemp = parseFloat(document.getElementById('targetTemp').value);

      if (isNaN(currentTemp) || isNaN(targetTemp)) {
        document.getElementById('result').textContent = 'Por favor, insira valores válidos.';
        return;
      }

      let remainingTemp = targetTemp - currentTemp;
      let elapsedTime = 0;

      for (let i = data.length - 1; i >= 0; i--) {
        const intervalTemp = data[i].temp - data[i - 1].temp;
        const intervalHours = 1;
        const intervalRate = intervalTemp / intervalHours;

        if (remainingTemp / intervalRate >= intervalHours) {
          remainingTemp -= intervalRate * intervalHours;
          elapsedTime += intervalHours;
        } else {
          elapsedTime += remainingTemp / intervalRate;
          break;
        }
      }

      const hours = Math.floor(elapsedTime);
      const minutes = Math.round((elapsedTime - hours) * 60);

      document.getElementById('result').textContent = `Tempo estimado: ${hours} horas e ${minutes} minutos.`;
    }
  </script>
</body>
</html>
